<!doctype html>
<html><head>
  <meta charset="utf-8">
  <title>Demo Tab Design</title>
  <script type = "text/javascript" 
         src = "https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <style>
    .RETabBar					{cursor:default; border-top:0px solid #202225; border-right:1px solid #464749; border-bottom:1px solid #202225; border-left:0px solid #202225;}
    .REtab						{height:22px; padding:0px 5px 0px 5px; background:linear-gradient(#B6B6B6, #4D4E50); border-top:1px solid #464749; border-right:0px solid #464749; border-bottom:0px solid #464749; border-left:1px solid #464749; color:#FFFFFF; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
    .REtab:hover				{height:22px; padding:0px 5px 0px 5px; background:linear-gradient(#C1C1C1, #68696B); border-top:1px solid #323335; border-right:0px solid #323335; border-bottom:0px solid #323335; border-left:1px solid #323335; color:#FFFFFF; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
    .REtabDown					{height:22px; padding:0px 5px 0px 5px; background:#323335; border-top:1px solid #464749; border-right:0px solid #464749; border-bottom:0px solid #464749; border-left:1px solid #464749; color:#FFFFFF; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
    .REtabColonyEvent			{height:22px; padding:0px 5px 0px 5px; background:linear-gradient(#EBB463,#E2680B); border-top:1px solid #464749; border-right:0px solid #464749; border-bottom:0px solid #464749; border-left:1px solid #464749; color:#FFFFFF; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
    .REtabColonyEvent:hover		{height:22px; padding:0px 5px 0px 5px; background:linear-gradient(#ECBD77, #E8731A); border-top:1px solid #323335; border-right:0px solid #323335; border-bottom:0px solid #323335; border-left:1px solid #323335; color:#FFFFFF; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
    .REtabDownColonyEvent		{height:22px; padding:0px 5px 0px 5px; background:#FF8515; border-top:1px solid #464749; border-right:0px solid #464749; border-bottom:0px solid #464749; border-left:1px solid #464749; color:#FFFFFF; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
    .REtabUnderAttack			{height:22px; padding:0px 5px 0px 5px; background:linear-gradient(#FF6262, #D60A0A); border-top:1px solid #464749; border-right:0px solid #464749; border-bottom:0px solid #464749; border-left:1px solid #464749; color:#FFFFFF; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
    .REtabUnderAttack:hover			{height:22px; padding:0px 5px 0px 5px; background:linear-gradient(#FD8686, #DA2929); border-top:1px solid #323335; border-right:0px solid #323335; border-bottom:0px solid #323335; border-left:1px solid #323335; color:#FFFFFF; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
    .REtabDownUnderAttack		{height:22px; padding:0px 5px 0px 5px; background:#CC0000; border-top:1px solid #464749; border-right:0px solid #464749; border-bottom:0px solid #464749; border-left:1px solid #464749; color:#FFFFFF; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
    .REtabColonyUnderAttack			{height:22px; padding:0px 5px 0px 5px; background:linear-gradient(#A80A0A, #F54949); border-top:1px solid #464749; border-right:0px solid #464749; border-bottom:0px solid #464749; border-left:1px solid #464749; color:#FFFFFF; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
    .REtabColonyUnderAttack:hover	{height:22px; padding:0px 5px 0px 5px; background:linear-gradient(#B21414, #FF5353); border-top:1px solid #323335; border-right:0px solid #323335; border-bottom:0px solid #323335; border-left:1px solid #323335; color:#FFFFFF; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
    .REtabDownColonyUnderAttack		{height:22px; padding:0px 5px 0px 5px; background:#A80A0A; border-top:1px solid #464749; border-right:0px solid #464749; border-bottom:0px solid #464749; border-left:1px solid #464749; color:#FFFFFF; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
	.REtable					{table-layout:fixed; display:None; border-top:0px solid #202225; border-right:1px solid #202225; border-bottom:1px solid #202225; border-left:1px solid #202225; border-collapse:collapse;}
	.REtable th					{padding:2px 0px 2px 0px; background:#494647; border-top:0px solid #202225; border-right:1px solid #202225; border-bottom:1px solid #202225; border-left:1px solid #202225; border-collapse:collapse; color:#FFFFFF; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
	.closebutton 				{background: white; color:black;}
	.closebutton:hover			{background: linear-gradient(#D10707,#920303); color:white; cursor:pointer; font-size: 1.2em;}
	.REtable td					{padding:2px 0px 2px 0px; border:1px solid #ADADAD; border-collapse:collapse; text-align:center; color:#222222; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
	.REtable tr:nth-child(even)	{background:#EDEDEE;}
	.REtable tr:nth-child(odd)	{background:#F6F6F7;}
	.REtableD					{table-layout:fixed; display:None; border-top:0px solid #202225; border-right:1px solid #202225; border-bottom:1px solid #202225; border-left:1px solid #202225; border-collapse:collapse;}
 	.REtableD th					{padding:2px 20px 0px 2px; background:#494647; border-top:0px solid #202225; border-right:1px solid #202225; border-bottom:1px solid #202225; border-left:1px solid #202225; border-collapse:collapse; color:#FFFFFF; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
 	.REtableD td					{padding:2px 20px 2px 2px; border:1px solid #ADADAD; border-collapse:collapse; text-align:right; color:#222222; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
 	.REtableD tr:nth-child(even)	{background:#EDEDEE;}
 	.REtableD tr:nth-child(odd)	{background:#F6F6F7;}
 	.REtableL					{table-layout:fixed; display:None; border-top:0px solid #202225; border-right:1px solid #202225; border-bottom:1px solid #202225; border-left:1px solid #202225; border-collapse:collapse;}
 	.REtableL th					{padding:2px 2px 0px 2px; background:#494647; border-top:0px solid #202225; border-right:1px solid #202225; border-bottom:1px solid #202225; border-left:1px solid #202225; border-collapse:collapse; color:#FFFFFF; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
 	.REtableL td					{padding:2px 2px 2px 20px; border:1px solid #ADADAD; border-collapse:collapse; text-align:left; color:#222222; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
 	.REtableL tr:nth-child(even)	{background:#EDEDEE;}
 	.REtableL tr:nth-child(odd)	{background:#F6F6F7;}
	.Summarytable 				{font-size:12px;color:#333333;width:100%;border-width: 1px;border-color: #a9a9a9;border-collapse: collapse;}
	.Summarytable th 			{font-size:20px;background-color:#b8b8b8;border-width: 1px;padding: 8px;border-style: solid;border-color: #a9a9a9;text-align:center;}
	.Summarytable tr 			{background-color:#DCD5D5;}
	.Summarytable td 			{font-size:15px;text-align:center;border-width: 1px;padding: 8px;border-style: solid;border-color: #a9a9a9;}
	.Summarytable tr:hover 		{background-color:#ffff99;}
	.UnderAttack 				{animation: blinker .5s linear infinite !important;}
	@keyframes blinker 			{50% {background: red;}}
	.REtable2 					{height:41px; border-top:0px solid #222222; border-right:1px solid #222222; border-bottom:1px solid #222222; border-left:1px solid #222222; background:linear-gradient(#3A3A3A, #151515); text-align:left; color:#FFFFFF; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
	.REtable3					{min-width:820px; color:#FFFFFF; font-family:DejaVu Sans, Verdana, Geneva, sans-serif; font-size:12px; font-weight:normal;}
	.REarmyTransport		{background: #CCFFCC !important;}
	.REarmyReinforce		{background: #E6CCFF !important;}
	.REarmyScout			{background: #ff9966 !important;}
	.REarmyBuildCity		{background: #ce9aff !important;}
	.REarmyAttack			{background: #ffb6b6 !important;}
	.REarmyColonize			{background: #b24205 !important;}
	.REarmySuppress			{background: #b24205 !important;}
	.REarmyAnticolonial		{background: #b24205 !important;}
	.REarmyDeploy			{background: #b24205 !important;}
	.REarmy 				{background: #ffffff !important;}
	.RElog					{overflow-y:scroll; overflow-x:hidden; background: white; height: 200px;}
	.REarmystale			{background: #abeaff !important;}
	.REarmyreturn			{background: #ffcfcf !important;}
	#accountDetails             {display:none;position: fixed;z-index: 1002;top:10px;}
  </style>
  <script>
	function getRegionName(x)
    {
        var y= new Array(new Array("Friesland","Lower Lorraine","Upper Lorraine","Burgundy"),new Array("Saxony","Franconia","Swabia","Lombardy"),new Array("North March","Thuringia","Bavaria","Tuscany"),new Array("Bohemia","Moravia","Carinthia","Romagna"));
        return y[Math.floor((x%800) / 200)][Math.floor((Math.floor(x/800)) / 200)];
      }
    function troopbeantostring(x){
    	var y={'peasants':'wo','militia':'w','scouter':'s','pikemen':'p','swordsmen':'sw','archer':'a','carriage':'t','lightCavalry':'c','heavyCavalry':'cata','ballista':'b','batteringRam':'r','catapult':'cp'}
    	var g="";
    	for (var p in x){
    		if (x[p]>0){
    			if (g!=""){
    				g+=",";
    			}
    			g+=(y[p]+":"+x[p]);
    		}
    	}
    	return g;
    }
    function armybeantostring(x,y){
    	var g="";
    	if (x.hero!=null){
    		g+=x.hero;
    	if (x.heroLevel!=null){
    		g+=("(Level "+x.heroLevel+")");
    	}
    }
    	if (y){
    		if (x.alliance!=null){
	    		if (g!=""){
    				g+=", ";
    			}
    			g+=("Alliance: "+x.alliance);
    		}
    		if (x.king!=null){
    			if (g!=""){
    				g+=", ";
    			}
    			g+=("From: "+x.king);
    		}
    	}
    	if (x.troop!=null){
    		var h=troopbeantostring(x.troop);
    		if (h!=""){
    			if (g!=""){
    				g+=", ";
    			}
    			g+=("Troop: "+h);
    		}
    	}
    	return g;
    }
	function gettimeleft(t){
		var x=t-(new Date().getTime());
		var seconds = Math.floor( (x/1000) % 60 );
		var minutes = Math.floor( (x/1000/60) % 60 );
		var hours = Math.floor( (x/(1000*60*60)) % 24 );
		var days = Math.floor( x/(1000*60*60*24) );
		var str="";
		if (days!=0){
			str=days+" Days";
		}
		if (hours!=0){
			str+=(" "+hours+" Hours");
		}
		if (minutes!=0){
			str+=(" "+minutes+" Minutes");
		}
		if (seconds!=0){
			str+=(" "+seconds+" Seconds");
		}
		return str;
	}
	function initializeclock(x){
		var timen=setInterval(function(){
		try{
			if (x==null){
				clearInterval(timen);
				return;
			}
		}
		catch(e){
			clearInterval(timen);
			return;
		}
		if (x.getAttribute("value")==null){
			x.innerHTML="";
			return;
		}
		if (x.getAttribute("value")=="null"){
			x.innerHTML="";
			return;
		}
		if (x.getAttribute("value")<(new Date().getTime())){
			x.innerHTML="";
			return;
		}
		var t=gettimeleft(x.getAttribute("value"));
		x.innerHTML=t;
		},1000);
	}
	function getcoord(x){
		return (x%800)+","+(Math.floor(x/800));
	}
	function getfieldid(x){
		return x.split(',')[0]+(x.split(',')[1]*800);
	}
	function closeaccountdetails(evt){
		document.getElementById("overlay").style.display="none";
		document.getElementById("accountDetails").style.display="none";
		clearInterval(Updater);
		PlayerData=null;
		SelectedId=null;
	}
	function detailsreceived(x){
		var url="retrieve.php?id="+x;
		Updater=setInterval(function(){
		$.getJSON(url,function(json){
			if (SelectedId!=x){
				return;
			}
			PlayerData=json;
			generateplayerinfo();
			generatecitytabs();
		});},10000);
	}
	function showaccountdetails(evt){
		document.getElementById("overlay").style.display="block";
		var evt=evt || window.event;
		var tg=evt.target;
		var uid=tg.getAttribute("value");
		var url="retrieve.php?id="+uid;
		SelectedId=uid;
		$.getJSON(url,function(json){
			if (SelectedId!=uid){
				return;
			}
			document.getElementById("accountDetails").style.display="block";
			detailsreceived(uid);
			PlayerData=json;
			generateplayerinfo();
			generatecitytabs();
		});
	}
	function updatewidth(){
		var x=document.getElementById("accountDetails").getElementsByTagName("table");
		var y=0;
		for (var i=0;i<x.length;i++){
			y=Math.max(y,x[i].offsetWidth);
		}
		var z=window.innerWidth;
		document.getElementById("accountDetails").style.left=Math.floor((z-y)/2)+"px";
		document.getElementById("REwarlog").style.width=y+"px";
		for (var i=0;i<x.length;i++){
			if (x[i].id == "REcitytab" || x[i].id=='logtabbar') continue;
			x[i].style.width=y+"px";
		}
	}
	function gettotalres(){
		var i={"gold":0,"food":0,"wood":0,"stone":0,"iron":0};
		for (var j=0;j<PlayerData.player.castles.length;j++){
			i.gold+=PlayerData.player.castles[j].resource.gold;
			i.stone+=PlayerData.player.castles[j].resource.stone.amount;
			i.iron+=PlayerData.player.castles[j].resource.iron.amount;
			i.wood+=PlayerData.player.castles[j].resource.wood.amount;
			i.food+=PlayerData.player.castles[j].resource.food.amount;
		}
		return i;
	}
	function getdistance(x,y){
		var i=(x%800)-(y%800);
		var j=(Math.floor(x/800))-(Math.floor(y/800));
		return Math.sqrt(i*i+j*j);
	}
	function getTabByFieldId(x){
		for (var i=0;i<document.getElementById("REcitytab").rows[0].cells.length;i++){
			if (document.getElementById("REcitytab").rows[0].cells[i].getAttribute("value")==x){
				return document.getElementById("REcitytab").rows[0].cells[i];
			}
		}
	}
	function doCityTabColors(){
		for (var i=0;i<PlayerData.player.castles.length;i++){
			var ty=PlayerData.player.castles[i];
			var classn=getTabByFieldId(ty.fieldId).className;
			var classnam="REtab";
			for (var j=0;j<ty.colonies.length;j++){
				if (ty.colonies[i].status==1||ty.colonies[i].status==3){
					var classnam="REtabColonyEvent";
				}
			}
			if (ty.enemyArmies.length>0){
				var classnam="REtabUnderAttack";
			}
			if (ty.enemyColonyArmies.length>0||ty.enemyValleyArmies.length>0){
				var classnam="REtabColonyUnderAttack";
			}
			if (classn.indexOf("Down")!=-1){
				classnam=classnam.replace("REtab","REtabDown");
			}
			getTabByFieldId(ty.fieldId).className=classnam;
		}
	}
	function draftmsg(x,y){
		var TROOP_EXP_VALUES= new Array(0,0,225,305,695,900,1350,1350,2975,2850,8750,10000,13750,29000);
		var troopIntNames=new Array("","","peasants","militia","scouter","pikemen","swordsmen","archer","carriage","lightCavalry","heavyCavalry","ballista","batteringRam","catapult");
		var _loc11_=x.availableTroop[y];
		var _loc13_=TROOP_EXP_VALUES[troopIntNames.indexOf(y)];
		var _loc12_=_loc11_* _loc13_;
		var _loc10_ = Math.floor(_loc12_ / 2147483647) % 2 == 0
		var ftr=(!_loc10_?"*<br />(undraftable)<br />-" + (Math.floor(_loc12_ % 2147483647 / _loc13_) + 1).toLocaleString() + "  +" + (Math.floor((2147483647 - _loc11_ % 2147483647) /_loc13_)).toLocaleString():_loc10_ && _loc11_ != 0?"(draftable) " + Math.round(_loc12_% 2147483647 * 100 / 2147483647 * 1000) / 1000 + "%<br />-"+(_loc11_ - Math.floor(_loc12_% 2147483647 / _loc13_) != 0?(Math.floor(_loc12_ % 2147483647 / _loc13_) + 1):0).toLocaleString()+"  +"+(Math.floor((2147483647 - _loc12_ % 2147483647) / _loc13_)).toLocaleString():"");
		if (ftr.indexOf("(draftable)")!=-1){
			ftr="<font color='red'>"+ftr+"</font>";
		}
		else{
			ftr="<font color='green'>"+ftr+"</font>";
		}
		return ftr;
	}
	function getmissiontype(x){
		var missionnames=["","Transport","Reinforce","Scout","Build City","Attack","","Colonize","Uprise","Suppress","Anti-colonial","Deploy"];
		var g=missionnames[x.missionType];
		if(x.direction!=1)
		{
			if(x.direction!=2)
			{
				g+=" at";
			}
			else
            {
               g+=" return";
            }
        }
        else
        {
            g+=" to";
        }
        return g;
    }
    function getembassyarmy(x){
    	var troopIntNames=new Array("peasants","militia","scouter","pikemen","swordsmen","archer","carriage","lightCavalry","heavyCavalry","ballista","batteringRam","catapult");
    	var t=new Object();
    	for (var i=0;i<troopIntNames.length;i++){
    		t[troopIntNames[i]]=0;
    	}
    	for (var i=0;i<x.friendlyArmies.length;i++){
    		if (x.friendlyArmies[i].direction==3){
    			for (var j=0;j<troopIntNames.length;j++){
    				t[troopIntNames[j]]+=x.friendlyArmies[i][troopIntNames[j]];
    			}
    		}
    	}
    	return t;
    }
	function updatedata(id){
	for (var i=0;i<PlayerData.player.castles.length;i++){
		if (PlayerData.player.castles[i].fieldId==id){
			var ty=PlayerData.player.castles[i];
			var x=document.getElementById("REcitysummary");
			x.rows[0].cells[0].innerHTML="<font color='white'><b>"+ty.name+"</b></font>";
			var pq="";
			if (ty.resource.support<25){
				pq+="<font color='red'>";
			}
			else{
				pq+="<font color='green'>";
			}
			pq+=("<b>"+ty.resource.support+"</b></font><font color='white'> / </font>");
			if (ty.resource.complaint==0){
				pq+="<font color='green'>";
			}
			else{
				pq+="<font color='red'>";
			}
			pq+=("<b>"+ty.resource.complaint+"</b></font>");
			x.rows[0].cells[2].innerHTML=pq;
			var pq="";
			if (ty.resource.texRate<50){
				pq+="<font color='green'>";
			}
			else{
				pq+="<font color='red'>";
			}
			pq+=("<b>"+ty.resource.texRate+"%</b></font>");
			x.rows[0].cells[4].innerHTML=pq;
			pq="<font color='white'>("+getcoord(ty.fieldId)+") "+getRegionName(ty.fieldId)+"</font>";
			x.rows[2].cells[0].innerHTML=pq;
			pq="";
			idlepop=ty.resource.maxPopulation-ty.resource.workPeople;
			if (ty.resource.maxPopulation>0){
				pq+="<font color='white'>";
			}
			else{
				pq+="<font color='red'>";
			}
			pq+=("<b>"+ty.resource.maxPopulation+"</b> / </font>");
			if (idlepop<0){
				pq+="<font color='red'>";
			}
			else{
				pq+="<font color='green'>";
			}
			pq+=("<b>"+idlepop+"</b></font>");
			x.rows[2].cells[2].innerHTML=pq;
			var x=document.getElementById("resources");
			var fcd=gettotalres();
			x.rows[1].cells[1].innerHTML=Math.floor(ty.resource.gold).toLocaleString();
 			x.rows[1].cells[2].innerHTML=Math.floor(fcd.gold).toLocaleString();
 			x.rows[1].cells[3].innerHTML=Math.floor(ty.resource.taxIncome+ty.resource.colonyGold-ty.resource.herosSalary).toLocaleString();
 			x.rows[2].cells[1].innerHTML=Math.floor(ty.resource.food.amount).toLocaleString();
 			x.rows[2].cells[2].innerHTML=Math.floor(fcd.food).toLocaleString();
 			x.rows[2].cells[3].innerHTML=Math.floor(ty.resource.food.increaseRate+ty.resource.colonyFood-ty.resource.troopCostFood).toLocaleString();
 			x.rows[3].cells[1].innerHTML=Math.floor(ty.resource.wood.amount).toLocaleString();
 			x.rows[3].cells[2].innerHTML=Math.floor(fcd.wood).toLocaleString();
 			x.rows[3].cells[3].innerHTML=Math.floor(ty.resource.wood.increaseRate+ty.resource.colonyWood).toLocaleString();
 			x.rows[4].cells[1].innerHTML=Math.floor(ty.resource.stone.amount).toLocaleString();
 			x.rows[4].cells[2].innerHTML=Math.floor(fcd.stone).toLocaleString();
 			x.rows[4].cells[3].innerHTML=Math.floor(ty.resource.stone.increaseRate+ty.resource.colonyStone).toLocaleString();
 			x.rows[5].cells[1].innerHTML=Math.floor(ty.resource.iron.amount).toLocaleString();
 			x.rows[5].cells[2].innerHTML=Math.floor(fcd.iron).toLocaleString();
 			x.rows[5].cells[3].innerHTML=Math.floor(ty.resource.iron.increaseRate+ty.resource.colonyIron).toLocaleString();
			x.rows[6].cells[1].innerHTML=ty.resource.maxPopulation.toLocaleString();
			var x=document.getElementById("techs");
			techtypes=["","Agriculture","Lumbering","Masonry","Mining","Metal Casting","","Informatics","Military Science","Military Tradition","Iron Working","Logistics","Compass","Horseback Riding","Archery","Stockpile","Medicine","Construction","Engineering","Machinery","Privateering"];
			for (var j=0;j<ty.researches.length;j++){
				for (var t=1;t<x.rows.length;t++){
					if (x.rows[t].cells[0].innerHTML==techtypes[ty.researches[j].typeId]){
						x.rows[t].cells[1].innerHTML=ty.researches[j].avalevel+"/"+ty.researches[j].level;
					}
				}
			}
			var x=document.getElementById("troops");
			x.rows[1].cells[1].innerHTML=ty.availableTroop.peasants.toLocaleString();
			x.rows[2].cells[1].innerHTML=ty.availableTroop.militia.toLocaleString();
			x.rows[3].cells[1].innerHTML=ty.availableTroop.scouter.toLocaleString();
			x.rows[4].cells[1].innerHTML=ty.availableTroop.pikemen.toLocaleString();
			x.rows[5].cells[1].innerHTML=ty.availableTroop.swordsmen.toLocaleString();
			x.rows[6].cells[1].innerHTML=ty.availableTroop.archer.toLocaleString();
			x.rows[7].cells[1].innerHTML=ty.availableTroop.lightCavalry.toLocaleString();
			x.rows[8].cells[1].innerHTML=ty.availableTroop.heavyCavalry.toLocaleString();
			x.rows[9].cells[1].innerHTML=ty.availableTroop.carriage.toLocaleString();
			x.rows[10].cells[1].innerHTML=ty.availableTroop.ballista.toLocaleString();
			x.rows[11].cells[1].innerHTML=ty.availableTroop.batteringRam.toLocaleString();
			x.rows[12].cells[1].innerHTML=ty.availableTroop.catapult.toLocaleString();
			x.rows[1].cells[2].innerHTML=draftmsg(ty,"peasants");
			x.rows[2].cells[2].innerHTML=draftmsg(ty,"militia");
			x.rows[3].cells[2].innerHTML=draftmsg(ty,"scouter");
			x.rows[4].cells[2].innerHTML=draftmsg(ty,"pikemen");
			x.rows[5].cells[2].innerHTML=draftmsg(ty,"swordsmen");
			x.rows[6].cells[2].innerHTML=draftmsg(ty,"archer");
			x.rows[7].cells[2].innerHTML=draftmsg(ty,"lightCavalry");
			x.rows[8].cells[2].innerHTML=draftmsg(ty,"heavyCavalry");
			x.rows[9].cells[2].innerHTML=draftmsg(ty,"carriage");
			x.rows[10].cells[2].innerHTML=draftmsg(ty,"ballista");
			x.rows[11].cells[2].innerHTML=draftmsg(ty,"batteringRam");
			x.rows[12].cells[2].innerHTML=draftmsg(ty,"catapult");
			x.rows[1].cells[3].innerHTML=ty.troop.peasants.toLocaleString();
			x.rows[2].cells[3].innerHTML=ty.troop.militia.toLocaleString();
			x.rows[3].cells[3].innerHTML=ty.troop.scouter.toLocaleString();
			x.rows[4].cells[3].innerHTML=ty.troop.pikemen.toLocaleString();
			x.rows[5].cells[3].innerHTML=ty.troop.swordsmen.toLocaleString();
			x.rows[6].cells[3].innerHTML=ty.troop.archer.toLocaleString();
			x.rows[7].cells[3].innerHTML=ty.troop.lightCavalry.toLocaleString();
			x.rows[8].cells[3].innerHTML=ty.troop.heavyCavalry.toLocaleString();
			x.rows[9].cells[3].innerHTML=ty.troop.carriage.toLocaleString();
			x.rows[10].cells[3].innerHTML=ty.troop.ballista.toLocaleString();
			x.rows[11].cells[3].innerHTML=ty.troop.batteringRam.toLocaleString();
			x.rows[12].cells[3].innerHTML=ty.troop.catapult.toLocaleString();
			var fcd=gettotaltroop(ty);
			x.rows[1].cells[4].innerHTML=fcd.peasants.toLocaleString();
			x.rows[2].cells[4].innerHTML=fcd.militia.toLocaleString();
			x.rows[3].cells[4].innerHTML=fcd.scouter.toLocaleString();
			x.rows[4].cells[4].innerHTML=fcd.pikemen.toLocaleString();
			x.rows[5].cells[4].innerHTML=fcd.swordsmen.toLocaleString();
			x.rows[6].cells[4].innerHTML=fcd.archer.toLocaleString();
			x.rows[7].cells[4].innerHTML=fcd.lightCavalry.toLocaleString();
			x.rows[8].cells[4].innerHTML=fcd.heavyCavalry.toLocaleString();
			x.rows[9].cells[4].innerHTML=fcd.carriage.toLocaleString();
			x.rows[10].cells[4].innerHTML=fcd.ballista.toLocaleString();
			x.rows[11].cells[4].innerHTML=fcd.batteringRam.toLocaleString();
			x.rows[12].cells[4].innerHTML=fcd.catapult.toLocaleString();
			x.rows[1].cells[5].innerHTML=ty.troopProduceQueue.peasants.toLocaleString();
			x.rows[2].cells[5].innerHTML=ty.troopProduceQueue.militia.toLocaleString();
			x.rows[3].cells[5].innerHTML=ty.troopProduceQueue.scouter.toLocaleString();
			x.rows[4].cells[5].innerHTML=ty.troopProduceQueue.pikemen.toLocaleString();
			x.rows[5].cells[5].innerHTML=ty.troopProduceQueue.swordsmen.toLocaleString();
			x.rows[6].cells[5].innerHTML=ty.troopProduceQueue.archer.toLocaleString();
			x.rows[7].cells[5].innerHTML=ty.troopProduceQueue.lightCavalry.toLocaleString();
			x.rows[8].cells[5].innerHTML=ty.troopProduceQueue.heavyCavalry.toLocaleString();
			x.rows[9].cells[5].innerHTML=ty.troopProduceQueue.carriage.toLocaleString();
			x.rows[10].cells[5].innerHTML=ty.troopProduceQueue.ballista.toLocaleString();
			x.rows[11].cells[5].innerHTML=ty.troopProduceQueue.batteringRam.toLocaleString();
			x.rows[12].cells[5].innerHTML=ty.troopProduceQueue.catapult.toLocaleString();
			var fcd=getembassyarmy(ty);
			x.rows[1].cells[6].innerHTML=fcd.peasants.toLocaleString();
			x.rows[2].cells[6].innerHTML=fcd.militia.toLocaleString();
			x.rows[3].cells[6].innerHTML=fcd.scouter.toLocaleString();
			x.rows[4].cells[6].innerHTML=fcd.pikemen.toLocaleString();
			x.rows[5].cells[6].innerHTML=fcd.swordsmen.toLocaleString();
			x.rows[6].cells[6].innerHTML=fcd.archer.toLocaleString();
			x.rows[7].cells[6].innerHTML=fcd.lightCavalry.toLocaleString();
			x.rows[8].cells[6].innerHTML=fcd.heavyCavalry.toLocaleString();
			x.rows[9].cells[6].innerHTML=fcd.carriage.toLocaleString();
			x.rows[10].cells[6].innerHTML=fcd.ballista.toLocaleString();
			x.rows[11].cells[6].innerHTML=fcd.batteringRam.toLocaleString();
			x.rows[12].cells[6].innerHTML=fcd.catapult.toLocaleString();
			var x=document.getElementById("fortifications");
			x.rows[1].cells[1].innerHTML=ty.fortification.trap.toLocaleString();
			x.rows[2].cells[1].innerHTML=ty.fortification.abatis.toLocaleString();
			x.rows[3].cells[1].innerHTML=ty.fortification.arrowTower.toLocaleString();
			x.rows[4].cells[1].innerHTML=ty.fortification.rollingLogs.toLocaleString();
			x.rows[5].cells[1].innerHTML=ty.fortification.rockfall.toLocaleString();
			x.rows[1].cells[2].innerHTML=ty.fortificationProduceQueue.trap.toLocaleString();
			x.rows[2].cells[2].innerHTML=ty.fortificationProduceQueue.abatis.toLocaleString();
			x.rows[3].cells[2].innerHTML=ty.fortificationProduceQueue.arrowTower.toLocaleString();
			x.rows[4].cells[2].innerHTML=ty.fortificationProduceQueue.rollingLogs.toLocaleString();
			x.rows[5].cells[2].innerHTML=ty.fortificationProduceQueue.rockfall.toLocaleString();
			var x=document.getElementById("gears");
			var GEARING_BONUSES=[0,0.4,0.75,1,1.32,1.74,2.3,3.04,4.01,5.29,6.98,9.22,12.17,16.06,21.2,27.98];
			for (var j=0;j<ty.gears.length;j++){
				x.rows[ty.gears[j]['typeId']].cells[1].innerHTML=ty.gears[j].avalevel+"/"+ty.gears[j].level;
				x.rows[ty.gears[j].typeId].cells[2].innerHTML=ty.gears[j].enhancedstarlv;
				x.rows[ty.gears[j].typeId].cells[3].innerHTML=ty.gears[j].typeId!=3?"+"+((ty.gears[j].avalevel + GEARING_BONUSES[ty.gears[j].enhancedstarlv])*(ty.gears[j].typeId==6||ty.gears[j].typeId ==5?2:1)).toLocaleString():"";
				x.rows[ty.gears[j].typeId].cells[4].setAttribute("value",ty.gears[j].endTime);
			}
			var x=document.getElementById("valleys");
			for (var j=ty.fieldsArray.length+1;j<x.rows.length;){
				x.removeChild(x.rows[j]);
			}
			for (var j=0;j<ty.fieldsArray.length;j++){
				if (x.rows[j+1]==null){
					var ght=document.createElement("tr");
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					x.appendChild(ght);
				}
				x.rows[j+1].cells[1].innerHTML=ty.fieldsArray[j].name;
				x.rows[j+1].cells[0].innerHTML=getcoord(ty.fieldsArray[j].id);
				x.rows[j+1].cells[2].innerHTML=ty.fieldsArray[j].level;
				x.rows[j+1].cells[3].innerHTML=getdistance(ty.fieldsArray[j].id,id).toLocaleString();
			}
			var x=document.getElementById("colonies");
			for (var j=ty.colonies.length+1;j<x.rows.length;){
				x.removeChild(x.rows[j]);
			}
			for (var j=0;j<ty.colonies.length;j++){
				if (x.rows[j+1]==null){
					var ght=document.createElement("tr");
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					x.appendChild(ght);
					initializeclock(ght.cells[4]);
				}
				x.rows[j+1].cells[1].innerHTML=ty.colonies[j].lordName;
				x.rows[j+1].cells[0].innerHTML=ty.colonies[j].position.replace(".",",");
				x.rows[j+1].cells[2].innerHTML=ty.colonies[j].prestige;
				x.rows[j+1].cells[3].innerHTML=(ty.colonies[j].relation==3)?"colony":"suzerain";
				x.rows[j+1].cells[4].setAttribute("value",ty.colonies[j].endTime);
			}
			var x=document.getElementById("localarmies");
			for (var j=ty.localarmies.length+1;j<x.rows.length;){
				x.removeChild(x.rows[j]);
			}
			var missionconstants=["","Transport","Reinforce","Scout","BuildCity","Attack","","Colonize","Uprise","Suppress","Anticolonial","Deploy"];
			for (var j=0;j<ty.localarmies.length;j++){
				if (x.rows[j+1]==null){
					var ght=document.createElement("tr");
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					x.appendChild(ght);
					initializeclock(ght.cells[3]);
				}
				x.rows[j+1].cells[3].setAttribute("value",ty.localarmies[j].reachTime);
				x.rows[j+1].cells[2].innerHTML=armybeantostring(ty.localarmies[j],false);
				x.rows[j+1].cells[0].innerHTML=getmissiontype(ty.localarmies[j]);
				x.rows[j+1].cells[1].innerHTML=ty.localarmies[j].targetPosName+" at "+getcoord(ty.localarmies[j].targetFieldId);
				x.rows[j+1].className=ty.localarmies[j].direction!=1?ty.localarmies[j].direction!=2?"REarmystale":"REarmyreturn":"REarmy"+missionconstants[ty.localarmies[j].missionType];
			}
			var x=document.getElementById("incomingarmies");
			for (var j=ty.selfArmies.length+ty.friendlyArmies.length+ty.enemyArmies.length+ty.enemyValleyArmies.length+ty.enemyColonyArmies.length+1;j<x.rows.length;){
				x.removeChild(x.rows[j]);
			}
			for (var j=0;j<ty.selfArmies.length;j++){
				if (x.rows[j+1]==null){
					var ght=document.createElement("tr");
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					x.appendChild(ght);
					initializeclock(ght.cells[3]);
				}
				x.rows[j+1].cells[0].innerHTML=getmissiontype(ty.selfArmies[j]);
				x.rows[j+1].cells[1].innerHTML=ty.selfArmies[j].targetPosName+" at "+getcoord(ty.selfArmies[j].targetFieldId);
				x.rows[j+1].cells[2].innerHTML=armybeantostring(ty.selfArmies[j],false);
				x.rows[j+1].cells[3].setAttribute("value",ty.selfArmies[j].reachTime);
				x.rows[j+1].className="RElocalarmy"+missionconstants[ty.selfArmies[j].missionType];
			}
			for (var j=0;j<ty.friendlyArmies.length;j++){
				if (x.rows[ty.selfArmies.length+j+1]==null){
					var ght=document.createElement("tr");
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					x.appendChild(ght);
					initializeclock(ght.cells[3]);
				}
				x.rows[ty.selfArmies.length+j+1].cells[0].innerHTML=getmissiontype(ty.friendlyArmies[j]);
				x.rows[ty.selfArmies.length+j+1].cells[1].innerHTML=ty.friendlyArmies[j].targetPosName+" at "+getcoord(ty.friendlyArmies[j].targetFieldId);
				x.rows[ty.selfArmies.length+j+1].cells[2].innerHTML=armybeantostring(ty.friendlyArmies[j],true);
				x.rows[ty.selfArmies.length+j+1].cells[3].setAttribute("value",ty.friendlyArmies[j].reachTime);
				x.rows[ty.selfArmies.length+j+1].className="REarmy"+missionconstants[ty.friendlyArmies[j].missionType];
			}
			for (var j=0;j<ty.enemyArmies.length;j++){
				if (x.rows[ty.selfArmies.length+ty.friendlyArmies.length+j+1]==null){
					var ght=document.createElement("tr");
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					x.appendChild(ght);
					initializeclock(ght.cells[3]);
				}
				x.rows[ty.selfArmies.length+ty.friendlyArmies.length+j+1].cells[0].innerHTML=getmissiontype(ty.enemyArmies[j]);
				x.rows[ty.selfArmies.length+ty.friendlyArmies.length+j+1].cells[1].innerHTML=ty.enemyArmies[j].targetPosName+" at "+getcoord(ty.enemyArmies[j].targetFieldId);
				x.rows[ty.selfArmies.length+ty.friendlyArmies.length+j+1].cells[2].innerHTML=armybeantostring(ty.enemyArmies[j],true);
				x.rows[ty.selfArmies.length+ty.friendlyArmies.length+j+1].cells[3].setAttribute("value",ty.enemyArmies[j].reachTime);
				x.rows[ty.selfArmies.length+ty.friendlyArmies.length+j+1].className="REarmy"+missionconstants[ty.enemyArmies[j].missionType];
			}
			for (var j=0;j<ty.enemyValleyArmies.length;j++){
				if (x.rows[ty.selfArmies.length+ty.friendlyArmies.length+ty.enemyArmies.length+j+1]==null){
					var ght=document.createElement("tr");
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					x.appendChild(ght);
					initializeclock(ght.cells[3]);
				}
				x.rows[ty.selfArmies.length+ty.friendlyArmies.length+ty.enemyArmies.length+j+1].cells[0].innerHTML=getmissiontype(ty.enemyValleyArmies[j]);
				x.rows[ty.selfArmies.length+ty.friendlyArmies.length+ty.enemyArmies.length+j+1].cells[1].innerHTML=ty.enemyValleyArmies[j].targetPosName+" at "+getcoord(ty.enemyArmies[j].targetFieldId);
				x.rows[ty.selfArmies.length+ty.friendlyArmies.length+ty.enemyArmies.length+j+1].cells[2].innerHTML=armybeantostring(ty.enemyValleyArmies[j],true);
				x.rows[ty.selfArmies.length+ty.friendlyArmies.length+ty.enemyArmies.length+j+1].cells[3].setAttribute("value",ty.enemyValleyArmies[j].reachTime);
				x.rows[ty.selfArmies.length+ty.friendlyArmies.length+ty.enemyArmies.length+j+1].className="REarmy"+missionconstants[ty.enemyValleyArmies[j].missionType];
			}
			for (var j=0;j<ty.enemyColonyArmies.length;j++){
				if (x.rows[ty.selfArmies.length+ty.friendlyArmies.length+ty.enemyValleyArmies.length+ty.enemyArmies.length+j+1]==null){
					var ght=document.createElement("tr");
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					ght.appendChild(document.createElement("td"));
					x.appendChild(ght);
					initializeclock(ght.cells[3]);
				}
				x.rows[ty.selfArmies.length+ty.friendlyArmies.length+ty.enemyValleyArmies.length+ty.enemyArmies.length+j+1].cells[0].innerHTML=getmissiontype(ty.enemyColonyArmies[j]);
				x.rows[ty.selfArmies.length+ty.friendlyArmies.length+ty.enemyValleyArmies.length+ty.enemyArmies.length+j+1].cells[1].innerHTML=ty.enemyColonyArmies[j].targetPosName+" at "+getcoord(ty.enemyColonyArmies[j].targetFieldId);
				x.rows[ty.selfArmies.length+ty.friendlyArmies.length+ty.enemyValleyArmies.length+ty.enemyArmies.length+j+1].cells[2].innerHTML=armybeantostring(ty.enemyColonyArmies[j],true);
				x.rows[ty.selfArmies.length+ty.friendlyArmies.length+ty.enemyValleyArmies.length+ty.enemyArmies.length+j+1].cells[3].setAttribute("value",ty.enemyColonyArmies[j].reachTime);
				x.rows[ty.selfArmies.length+ty.friendlyArmies.length+ty.enemyValleyArmies.length+ty.enemyArmies.length+j+1].className="REarmy"+missionconstants[ty.enemyColonyArmies[j].missionType];
			}
			buildingtypes=[0,32,1,2,4,5,6,7,20,22,23,21,24,25,26,27,28,29,3,30,31];
			var x=document.getElementById("buildings");
			for (var t=1;t<x.rows.length;t++){
				x.rows[t].cells[1].innerHTML="";
				for (var j=0;j<ty.buildings.length;j++){
					if (ty.buildings[j].typeId==buildingtypes[t]){
						if (x.rows[t].cells[1].innerHTML!=""){
							x.rows[t].cells[1].innerHTML+=", ";
						}
						x.rows[t].cells[1].innerHTML+=ty.buildings[j].level;
					}
				}
			}
		}
	}
	updatewidth();
	}
	function getTitle(param1)
      {
      	var titles=["Civilian","Knight","Baronet","Baron","Viscount","Earl","Marquis","Duke","Furstin","Prinzessin"]
      	try{
      		return titles[param1];
      	}
      	catch(e){
      		return "";
      	}
      }
	function gettotaltroop(){
		var x=new Object();
		for (var i=0;i<PlayerData.player.castles.length;i++){
			for (var t in PlayerData.player.castles[i].troop){
				x[t]=(x[t]!=null)?(x[t]+PlayerData.player.castles[i].troop[t]):PlayerData.player.castles[i].troop[t];
			}
		}
		return x;
	}
	function generatesummary(x){
		var t=new Object();
		var y1=new Array();
		var y2=new Array();
		for (var i=0;i<x.length;i++){
			if (x[i][3]>0){
				y1.push(x[i]);
			}
			else{
				y2.push(x[i]);
			}
		}
		for (var i=0;i<y1.length;i++){
			var xp=y1[i];
			if (document.getElementById("summary").rows[i+1]==null){
				var d=document.createElement("tr")
				document.getElementById("summary").appendChild(d);
				var y=d.insertCell(-1);
				var y=d.insertCell(-1);
				var y=d.insertCell(-1);
				var y=d.insertCell(-1);
				var y=d.insertCell(-1);
			}
			var fgt=document.getElementById("summary").rows[i+1];
			fgt.className="UnderAttack";
			fgt.cells[0].innerHTML=xp[0];
			fgt.cells[1].innerHTML=xp[1];
			fgt.cells[2].innerHTML=xp[2];
			fgt.cells[3].innerHTML=xp[3];
			fgt.cells[4].innerHTML="<button onclick='showaccountdetails(event)' value='"+xp[4]+"'>Show Details</button>";
		}
		for (;i<y2.length+y1.length;i++){
			var xp=y2[i-y1.length];
			if (document.getElementById("summary").rows[i+1]==null){
				var d=document.createElement("tr")
				document.getElementById("summary").appendChild(d);
				var y=d.insertCell(-1);
				var y=d.insertCell(-1);
				var y=d.insertCell(-1);
				var y=d.insertCell(-1);
				var y=d.insertCell(-1);
			}
			var fgt=document.getElementById("summary").rows[i+1];
			fgt.className="";
			fgt.cells[0].innerHTML=xp[0];
			fgt.cells[1].innerHTML=xp[1];
			fgt.cells[2].innerHTML=xp[2];
			fgt.cells[3].innerHTML=xp[3];
			fgt.cells[4].innerHTML="<button onclick='showaccountdetails(event)' value='"+xp[4]+"'>Show Details</button>";
		}
		for (;(i+1)<document.getElementById("summary").rows.length;){
			document.getElementById("summary").removeChild(document.getElementById("summary").rows[i+1]);
		}
	}
	function getsummarydata(){
		$.getJSON("summary.php",function(json){generatesummary(json);});
	}
	function cleanupfont(x){
		var tg=document.createElement("html");
		tg.innerHTML=x;
		var st=tg.getElementsByTagName("font");
		for (var i=0;i<st.length;i++){
			st[i].removeAttribute("size");
		}
		return tg.innerHTML;
	}
	function generateplayerinfo(){
		var x=document.getElementById("REplayerinfo");
		x.rows[0].cells[0].innerHTML="<font color='white'><b>"+PlayerData.player.playerInfo.userName+"</b></font>";
		x.rows[0].cells[2].innerHTML=PlayerData.server;
		x.rows[0].cells[4].innerHTML=PlayerData.player.playerInfo.alliance?PlayerData.player.playerInfo.alliance:"(no alliance)";
		x.rows[0].cells[6].innerHTML=PlayerData.player.playerInfo.prestige.toLocaleString();
		x.rows[0].cells[8].innerHTML=PlayerData.player.playerInfo.office;
		x.rows[0].cells[10].innerHTML=PlayerData.player.playerInfo.medal.toLocaleString();
		x.rows[2].cells[1].innerHTML=PlayerData.player.playerInfo.ranking.toLocaleString();
		var v=PlayerData.player.playerInfo.allianceLevel;
		x.rows[2].cells[2].innerHTML=(v==8)?"Member":(v==10)?"Officer":(v==5)?"Presbyter":(v==2)?"Vice Host":(v==4)?"Host":"";
		x.rows[2].cells[4].innerHTML=PlayerData.player.playerInfo.honor;
		x.rows[2].cells[6].innerHTML=getTitle(PlayerData.player.playerInfo.titleId);
		document.getElementById("REwarlog").innerHTML=cleanupfont(PlayerData.warlog).split("\n").join("<br>");
		document.getElementById("REwarlog").scrollTop=document.getElementById("REwarlog").scrollHeight;
		updatewidth();
	}
	function citytabclick(evt){
	evt = evt || window.event;
	var target=evt.target || evt.srcElement;
	var tabBar = document.getElementById("REcitytab");
      for (var i = 0;i<tabBar.rows.length; i++)
      {
		var tr=tabBar.rows[i];
        for (var j = 0;j<tr.cells.length; j++)
        {
			var tab=tr.cells[j];
			tab.className = tab.className.replace("REtabDown","REtab");
        }
      }
      target.className = target.className.replace("REtab","REtabDown");
	  updatedata(target.getAttribute("value"));
	}
    function tabBarClick(evt)
    {
      evt = evt || window.event;
      var target = evt.target || evt.srcElement;
      var tabBar = document.getElementById("REtabBarContainer");
      for (var i = 0;i<tabBar.rows.length; i++)
      {
		var tr=tabBar.rows[i];
        for (var j = 0;j<tr.cells.length; j++)
        {
			var tab=tr.cells[j];
			tab.className = "REtab";
			document.getElementById(tab.innerHTML.toLowerCase().replace(" ","")).style.display="none";
        }
      }
      target.className = "REtabDown";
	  var tabl=document.getElementById(target.innerHTML.toLowerCase().replace(" ",""));
	  tabl.style.display="table";
	  updatewidth();
    }
	function generatecitytabs(){
		var y=document.getElementById("REcitytab").rows[0];
		for (var i=PlayerData.player.castles.length;i<y.cells.length;){
			y.removeChild(y.cells[i]);
		}
		var allup=true;
		for (var i=0;i<PlayerData.player.castles.length;i++){
			if (y.cells[i]==null){
				var z=document.createElement("td");
				z.className="REtab";
				y.appendChild(z);
			}
			y.cells[i].innerHTML=PlayerData.player.castles[i].name+"("+getcoord(PlayerData.player.castles[i].fieldId)+")";
			y.cells[i].setAttribute("value",PlayerData.player.castles[i].fieldId);
			if (y.cells[i].className.indexOf("REtabDown")!=-1){
				y.cells[i].click();
				allup=false;
			}
		}
		if (allup){
			y.cells[0].className="REtabDown";
			y.cells[0].click();
			document.getElementById("REtabBarContainer").rows[0].cells[0].click();
		}
		doCityTabColors();
		updatewidth();
	}
	function startclocks(){
		var x=document.getElementById("gears");
		for (var i=1;i<x.rows.length;i++){
			initializeclock(x.rows[i].cells[4]);
		}
	}
  </script>
</head><body onload="getsummarydata();setInterval(getsummarydata,30000);">
<div id="accountDetails" style="background:#636467;">
 <div id="buttoncontainer" style="background: white; height:27px;">
       <div class="closebutton" style="float: right; height: 25px; width:50px; text-align:center; vertical-align: middle; line-height:25px;" onclick="closeaccountdetails(event)">X</div>
    </div>

<table id="REplayerinfo" class="REtable3">
  <tr>
	<td width="220" rowspan="3" background="name.png" style="padding:0px 0px 12px 0px; background-repeat:no-repeat; background-position:center center; text-align:center;"></td>
	<td width="34"><img border="0" src="age2.png"></td>
	<td></td>
	<td width="17"><img border="0" src="alliance.png"></td>
	<td></td>
	<td width="17"><img border="0" src="prestige.png"></td>
	<td></td>
	<td width="17"><img border="0" src="office.png"></td>
	<td></td>
	<td width="17"><img border="0" src="cents.png"></td>
	<td></td>
  </tr>
  <tr>
    <td height="2" colspan="10" style="line-height:2px; font-size:1px;"><img border="0" width="100%" height="2" src="cityInfoLine.png"></td>
  </tr>
  <tr>
	<td width="34" align="right"><img border="0" src="rank.png"></td>
	<td></td>
	<td colspan="2"></td>
	<td width="17"><img border="0" src="honor.png"></td>
	<td></td>
	<td width="17"><img border="0" src="title.png"></td>
	<td colspan="3"></td>
  </tr>
</table>
<table id="REcitytab" name="REcitytab" cellpadding="0" cellspacing="0" class="RETabBar">
  <tr onclick="citytabclick(event);"></tr>
</table>
<table id="REcitysummary" class="REtable2">
  <tr>
	<td width="260" height="17" style="line-height:17px;"></td>
	<td width="20"><img border="0" src="loy.png"></td>
	<td width="210"></td>
	<td width="20"><img border="0" src="tax.png"></td>
	<td></td>
  </tr>
  <tr>
    <td height="2" colspan="5" style="line-height:2px; font-size:1px;"><img border="0" width="100%" height="2" src="cityInfoLine.png"></td>
  </tr>
  <tr>
	<td height="22" style="line-height:22px;"></td>
	<td style="width: 20px"><img border="0" src="pop.png"></td>
	<td></td>
  </tr>
</table>
<table id="REtabBarContainer" name="REtabBarContainer" cellpadding="0" cellspacing="0" class="RETabBar">
  <tr onClick="tabBarClick(event);">
    <td class="REtabDown">Resources</td>
    <td class="REtab">Valleys</td>
    <td class="REtab">Colonies</td>
    <td class="REtab">Buildings</td>
    <td class="REtab">Techs</td>
    <td class="REtab">Gears</td>
    <td class="REtab">Local Armies</td>
    <td class="REtab">Troops</td>
    <td class="REtab">Fortifications</td>
    <td class="REtab">Incoming Armies</td>
  </tr>
</table>
<div style="height: 200px;overflow: auto;">
<table id="resources" class="REtableD">
  <tr>
	<th>Resource</th>
	<th>Amount</th>
	<th>All</th>
	<th>Rate</th>
  </tr>
  <tr>
	<td>Gold</td>
	<td></td>
	<td></td>
	<td></td>
  </tr>
  <tr>
	<td>Food</td>
	<td></td>
	<td></td>
	<td></td>
  </tr>
  <tr>
	<td>Lumber</td>
	<td></td>
	<td></td>
	<td></td>
  </tr>
  <tr>
	<td>Stone</td>
	<td></td>
	<td></td>
	<td></td>
  </tr>
  <tr>
	<td>Iron</td>
	<td></td>
	<td></td>
	<td></td>
  </tr>
  <tr>
	<td>Population</td>
	<td></td>
	<td></td>
	<td></td>
  </tr>
</table>
<table id="valleys" class="REtable">
<tr>
	<th>Co-ordinate</th>
	<th>Type</th>
	<th>Level</th>
	<th>Distance</th>
</tr>
</table>
<table id="colonies" class="REtable">
<tr>
	<th style="width: 12%">Location</th>
	<th style="width: 20%">Lord</th>
	<th style="width: 20%">Prestige</th>
	<th style="width: 12%">Relation</th>
	<th style="width: 30%">Event Time</th>
</tr>
</table>
<table id="buildings" class="REtableL">
<tr>
	<th width="20%">Building</th>
	<th width="80%">Level(s)</th>
</tr>
<tr>
	<td>Wall</td>
	<td></td>
</tr>
<tr>
	<td>Cottage</td>
	<td></td>
</tr>
<tr>
	<td>Barrack</td>
	<td></td>
</tr>
<tr>
	<td>Sawmill</td>
	<td></td>
</tr>
<tr>
	<td>Quarry</td>
	<td></td>
</tr>
<tr>
	<td>Ironmine</td>
	<td></td>
</tr>
<tr>
	<td>Farm</td>
	<td></td>
</tr>
<tr>
	<td>Stable</td>
	<td></td>
</tr>
<tr>
	<td>Forge</td>
	<td></td>
</tr>
<tr>
	<td>Market</td>
	<td></td>
</tr>
<tr>
	<td>Inn</td>
	<td></td>
</tr>
<tr>
	<td>Relief Station</td>
	<td></td>
</tr>
<tr>
	<td>Academy</td>
	<td></td>
</tr>
<tr>
	<td>Workshop</td>
	<td></td>
</tr>
<tr>
	<td>Feasting Hall</td>
	<td></td>
</tr>
<tr>
	<td>Embassy</td>
	<td></td>
</tr>
<tr>
	<td>Rally Spot</td>
	<td></td>
</tr>
<tr>
	<td>Warehouse</td>
	<td></td>
</tr>
<tr>
	<td>Beacon Tower</td>
	<td></td>
</tr>
<tr>
	<td>Townhall</td>
	<td></td>
</tr>
</table>
<table id="techs" class="REtable">
<tr>
	<th>Research Name</th>
	<th>Level</th>
</tr>
<tr>
	<td>Agriculture</td>
	<td></td>
</tr>
<tr>
	<td>Lumbering</td>
	<td></td>
</tr>
<tr>
	<td>Masonry</td>
	<td></td>
</tr>
<tr>
	<td>Mining</td>
	<td></td>
</tr>
<tr>
	<td>Metal Casting</td>
	<td></td>
</tr>
<tr>
	<td>Informatics</td>
	<td></td>
</tr>
<tr>
	<td>Military Science</td>
	<td></td>
</tr>
<tr>
	<td>Military Tradition</td>
	<td></td>
</tr>
<tr>
	<td>Iron Working</td>
	<td></td>
</tr>
<tr>
	<td>Logistics</td>
	<td></td>
</tr>
<tr>
	<td>Compass</td>
	<td></td>
</tr>
<tr>
	<td>Horseback Riding</td>
	<td></td>
</tr>
<tr>
	<td>Archery</td>
	<td></td>
</tr>
<tr>
	<td>Stockpile</td>
	<td></td>
</tr>
<tr>
	<td>Construction</td>
	<td></td>
</tr>
<tr>
	<td>Medicine</td>
	<td></td>
</tr>
<tr>
	<td>Machinery</td>
	<td></td>
</tr>
<tr>
	<td>Engineering</td>
	<td></td>
</tr>
<tr>
	<td>Privateering</td>
	<td></td>
</tr>
</table>
<table id="gears" class="REtable">
<tr>
	<th>Gear Name</th>
	<th>Level</th>
	<th>Star</th>
	<th>Bonus</th>
	<th>Cooldown</th>
</tr>
<tr>
	<td>Weapon</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Shield</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Mount</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Necklace</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Charm</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Ring</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Head</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Shoulder</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Chest</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Back</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Gauntlets</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Belts</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Legs</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Foot</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
</table>
<table id="localarmies" class="REtable">
<tr>
	<th>Army</th>
	<th>Target</th>
	<th>Troop</th>
	<th>Remain Time</th>
</tr>
</table>
<table id="troops" class="REtable">
<tr>
	<th>Troop</th>
	<th>Available</th>
	<th>Draft Offset</th>
	<th>Total</th>
	<th>All</th>
	<th>Queue</th>
	<th>Reinforcement</th>
</tr>
<tr>
	<td>Worker</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Warrior</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Scout</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Pikemen</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Swordsmen</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Archer</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Cavalry</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Cataphract</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Transport</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Ballista</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Battering Ram</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Catapult</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
</table>
<table id="fortifications" class="REtable">
<tr>
	<th>Fortification</th>
	<th>Available</th>
	<th>In Queues</th>
</tr>
<tr>
	<td>Trap</td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Abatis</td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Archer Tower</td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Rolling Log</td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Trebuchev</td>
	<td></td>
	<td></td>
</tr>
</table>
<table id="incomingarmies" class="REtable">
<tr>
	<th>Mission Type</th>
	<th>From</th>
	<th>Troop</th>
	<th>Remain time</th>
</tr>
</table>
</div>
<table class="RETabBar" cellpadding="0" cellspacing="0" id="logtabbar">
<tr>
<td class="REtabDown">War Log</td></tr></table>
<div class="RElog" id="REwarlog">
</div>
</div>
<div>
<table id="summary" class="Summarytable">
<tr>
	<th style="width: 15%">Name</th>
	<th style="width: 30%">Resources</th>
	<th style="width: 30%">Troops</th>
	<th style="width: 15%">Incoming Attacks</th>
	<th style="width: 10%"></th>
</tr>
</table>
</div>
<div id="overlay" style="height:100%; bottom:0;width:100%; display: none;z-index:1001;background-color:black;position:fixed;opacity:.80; top:0;left:0;"></div>
</body>
</html>
